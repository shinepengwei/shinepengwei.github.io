---
layout: post
title: Python中的浅拷贝和深拷贝
categories:
- Python
- 技术
tags: []
status: publish
type: post
published: true
meta:
  _edit_last: '1'
  _wp_old_slug: python%e4%b8%ad%e7%9a%84%e6%b5%85%e6%8b%b7%e8%b4%9d%e5%92%8c%e6%b7%b1%e6%8b%b7%e8%b4%9d
  _syntaxhighlighter_encoded: '1'
---
<h1>Python中的浅拷贝和深拷贝</h1>
在<em>Python语法基础</em>中已经介绍了Python的内存管理方式，Python的赋值其实是简单的对象引用，同时通过对象计数的方式对对象进行管理。由此可以，当对一个对象进行拷贝到的时候，其实就是进行了简单的引用和计数加一。
<h2>浅拷贝实例</h2>
例如创建一个person对象，然后将这个对象为一对夫妻拷贝一份（使用切片操作和工厂方法）：

[python]
&gt;&gt;&gt;person=['name',['savings',100]]
&gt;&gt;&gt;hubby=person[:]
&gt;&gt;&gt;wifey=list(person)
&gt;&gt;&gt;[id(x) for x in person,hubby,wifey]
[102231,102423,102333]
[/python]

由上述结果可知，person、hubby和wifey分别为三个不同的对象，他们的内存管理方式应该是这样的：
<img class="aligncenter size-full wp-image-1548" title="122313_0822_Python1.png" src="http://www.codingart.info/wp-content/uploads/2013/12/122313_0822_Python1.png" alt="" width="686" height="372" />
对夫妻双方信息进行更新：

[python]
&gt;&gt;&gt;hubby[0]='joe'
&gt;&gt;&gt;wifey[0]='jane'
&gt;&gt;&gt;hubby,wifey
(['joe',['savings',100]],['jane',['savings',100]])
[/python]

现在的内存应该是这样的：
<img class="aligncenter size-full wp-image-1558" title="122313_0822_Python1.png" src="http://www.codingart.info/wp-content/uploads/2013/12/122313_0822_Python11.png" alt="" width="686" height="414" />

现在对存款帐号进行更新：

[python]
&gt;&gt;&gt;hubby[1][1]=50
&gt;&gt;&gt;hubby,wifey
(['joe',['savings',50]],['jane',['savings',50]])
[/python]

只对丈夫的账号进行了更新，却发现妻子的账号也更新了，这是因为我们只使用了浅拷贝，对于第二个列表元素（存款），其实丈夫和妻子对象指向的是一个对象。那为什么第一个元素（名字）修改没有影响？那是因为第一个元素是不可变的，而第二个时刻变得。

这时他们的内存对象应该是这样的：
<img title="122313_0822_Python2.png" src="http://www.codingart.info/wp-content/uploads/2013/12/122313_0822_Python21.png" alt="" width="691" height="431" />
<h2>深拷贝方法</h2>
如何实现深拷贝：copy.deepcopy()函数

[python]
&gt;&gt;&gt;person=['name',['savings',100]]
&gt;&gt;&gt;hubby=person
&gt;&gt;&gt;import copy
&gt;&gt;&gt;wifey=copy.deepcopy(person)
&gt;&gt;&gt;wifey=list(person)
&gt;&gt;&gt;hubby[0]='joe'
&gt;&gt;&gt;wifey[0]='jane'
&gt;&gt;&gt;hubby,wifey
(['joe',['savings',100]],['jane',['savings',100]])
&gt;&gt;&gt;hubby[1][1]=50
&gt;&gt;&gt;hubby,wifey
(['joe',['savings',50]],['jane',['savings',100]])
[/python]

注意：
<ul>
	<li>非容器类型（如数字、字符串和其他原子类型对象）没有被拷贝一说，</li>
	<li>如果元组变量只包含原子类型对象，对他进行深拷贝将不会被进行。比如将上述例子中的账户信息改成元组，那就不可以被深拷贝。</li>
</ul>
&nbsp;

后序若有修改，请查看evernote共享：<a href="https://www.evernote.com/shard/s70/sh/e57ccf00-fbdf-4279-b052-49918747ec76/53eb085149a0e29b7e735fa33c1b44c5#">https://www.evernote.com/shard/s70/sh/e57ccf00-fbdf-4279-b052-49918747ec76/53eb085149a0e29b7e735fa33c1b44c5#</a>
